<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuoGerman - Âæ∑ÊñáÂñÆÂ≠óÁâπË®ì</title>
    <style>
        :root {
            --duo-green: #58cc02;
            --duo-green-dark: #46a302;
            --duo-red: #ff4b4b;
            --duo-red-dark: #d42a2a;
            --duo-blue: #1cb0f6;
            --duo-blue-dark: #1480b3;
            --duo-gray: #e5e5e5;
            --duo-text: #4b4b4b;
            --bg: #fff;
        }

        body {
            font-family: "Nunito", "Segoe UI", "Microsoft JhengHei", sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            background-color: var(--bg);
            color: var(--duo-text);
            overflow: hidden;
        }

        /* Header & Progress */
        .header {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-sizing: border-box;
        }

        .close-btn {
            font-size: 24px;
            color: #afafaf;
            cursor: pointer;
            font-weight: bold;
        }

        .progress-container {
            flex-grow: 1;
            height: 16px;
            background-color: var(--duo-gray);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--duo-green);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        /* Game Area */
        .game-area {
            flex-grow: 1;
            width: 100%;
            max-width: 600px;
            padding: 0 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box;
            margin-bottom: 100px; /* Space for bottom sheet */
        }

        h2 {
            text-align: left;
            font-size: 1.5rem;
            margin-bottom: 30px;
        }

        .word-display {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #3c3c3c;
            border: 2px solid #e5e5e5;
            padding: 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .word-icon { font-size: 1.5rem; }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 400px) {
            .options-grid.articles { grid-template-columns: 1fr 1fr 1fr; }
            .options-grid.choices { grid-template-columns: 1fr 1fr; }
        }

        .option-btn {
            background: white;
            border: 2px solid var(--duo-gray);
            border-bottom-width: 4px;
            border-radius: 15px;
            padding: 15px;
            font-size: 1.1rem;
            color: var(--duo-text);
            cursor: pointer;
            transition: all 0.1s;
            text-align: center;
            position: relative;
        }

        .option-btn:active {
            transform: translateY(2px);
            border-bottom-width: 2px;
        }

        .option-btn:hover { background-color: #f7f7f7; }

        .option-btn.selected {
            background-color: #ddf4ff;
            border-color: var(--duo-blue);
            color: var(--duo-blue-dark);
        }

        .option-btn.correct {
            background-color: #d7ffb8;
            border-color: var(--duo-green);
            color: var(--duo-green-dark);
        }

        .option-btn.wrong {
            background-color: #ffdfe0;
            border-color: var(--duo-red);
            color: var(--duo-red-dark);
        }

        /* Bottom Sheet (Feedback) */
        .bottom-sheet {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 20px; /* Reduced padding */
            box-sizing: border-box;
            border-top: 2px solid transparent;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
        }

        .bottom-sheet.show { transform: translateY(0); }

        .bottom-sheet.correct {
            background-color: #d7ffb8;
            border-color: transparent;
            color: var(--duo-green-dark);
        }

        .bottom-sheet.wrong {
            background-color: #ffdfe0;
            border-color: transparent;
            color: var(--duo-red-dark);
        }

        .feedback-content {
            width: 100%;
            max-width: 600px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-text {
            font-weight: bold;
            font-size: 1.2rem;
            display: flex;
            flex-direction: column;
        }
        
        .feedback-sub {
            font-size: 0.9rem;
            font-weight: normal;
            margin-top: 5px;
        }

        .next-btn {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border-radius: 15px;
            border: none;
            font-size: 1.2rem;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            color: white;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        .bottom-sheet.correct .next-btn {
            background-color: var(--duo-green);
            box-shadow: 0 4px 0 var(--duo-green-dark);
        }

        .bottom-sheet.wrong .next-btn {
            background-color: var(--duo-red);
            box-shadow: 0 4px 0 var(--duo-red-dark);
        }

        /* Sound Icon */
        .speaker { cursor: pointer; color: var(--duo-blue); margin-left: 10px; }

        /* Article Specific Colors (optional cues) */
        .art-der { color: #1cb0f6; font-weight: bold; }
        .art-die { color: #ff4b4b; font-weight: bold; }
        .art-das { color: #58cc02; font-weight: bold; }

    </style>
</head>
<body>

    <div class="header">
        <div class="close-btn" onclick="location.reload()">√ó</div>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        <div style="font-weight: bold; color: #ff4b4b;">‚ù§ 5</div>
    </div>

    <div class="game-area" id="game-area">
        </div>

    <div class="bottom-sheet" id="bottom-sheet">
        <div class="feedback-content">
            <div class="feedback-text" id="feedback-msg">
                Â§™Ê£í‰∫ÜÔºÅ
                <span class="feedback-sub" id="feedback-detail"></span>
            </div>
            <div style="font-size: 40px;" id="feedback-icon">üéâ</div>
        </div>
        <button class="next-btn" onclick="nextQuestion()">ÁπºÁ∫å</button>
    </div>

<script>
    // --- Data Source (Extracted from your PDF) ---
    const vocabData = [
         // --- PAGE 1: Der ---
        { de: "Gegenstand", cn: "Áâ©‰ª∂", art: "der", type: "noun" },
        { de: "Preis", cn: "ÂÉπÊ†º", art: "der", type: "noun" },
        { de: "Bleistift", cn: "ÈâõÁ≠Ü", art: "der", type: "noun" },
        { de: "Computer", cn: "ÈõªËÖ¶", art: "der", type: "noun" },
        { de: "Drucker", cn: "Âç∞Ë°®Ê©ü", art: "der", type: "noun" },
        { de: "Fernseher", cn: "ÈõªË¶ñ", art: "der", type: "noun" },
        { de: "Herd", cn: "ÁàêÂ≠ê", art: "der", type: "noun" },
        { de: "Kuli", cn: "ÂéüÂ≠êÁ≠Ü", art: "der", type: "noun" },
        { de: "MP3-Player", cn: "MP3Êí≠ÊîæÂô®", art: "der", type: "noun" },
        { de: "Stuhl", cn: "Ê§ÖÂ≠ê", art: "der", type: "noun" },
        { de: "Tisch", cn: "Ê°åÂ≠ê", art: "der", type: "noun" },
        { de: "Wasserkocher", cn: "ÁÖÆÊ∞¥Âô®", art: "der", type: "noun" },
        { de: "K√§ufer", cn: "Ë≤∑Êñπ", art: "der", type: "noun" },
        { de: "Verk√§ufer", cn: "Ë≥£Êñπ", art: "der", type: "noun" },
        { de: "Kinderwagen", cn: "Â¨∞ÂÖíÊé®Ëªä", art: "der", type: "noun" },
        { de: "K√ºhlschrank", cn: "ÂÜ∞ÁÆ±", art: "der", type: "noun" },
        { de: "Staubsauger", cn: "Âê∏Â°µÂô®", art: "der", type: "noun" },
        { de: "Kunde", cn: "È°ßÂÆ¢", art: "der", type: "noun" },
        { de: "Schrank", cn: "Ê´ÉÂ≠ê", art: "der", type: "noun" },
        { de: "Morgen", cn: "Êó©Êô®", art: "der", type: "noun" },
        { de: "Pizza-Service", cn: "Êä´Ëñ©Â§ñÈÄÅ", art: "der", type: "noun" },
        { de: "Sohn", cn: "ÂÖíÂ≠ê", art: "der", type: "noun" },
        { de: "Tagesablauf", cn: "‰∏ÄÂ§©ÊµÅÁ®ã", art: "der", type: "noun" },
        { de: "Unterricht", cn: "Ë™≤Á®ã", art: "der", type: "noun" },
        { de: "Wortakzent", cn: "ÈáçÈü≥", art: "der", type: "noun" },
        { de: "Abend", cn: "Êôö‰∏ä", art: "der", type: "noun" },
        { de: "Mittag", cn: "‰∏≠Âçà", art: "der", type: "noun" },
        
        // --- PAGE 1: Die ---
        { de: "Kleinanzeige", cn: "ÂàÜÈ°ûÂ∞èÂª£Âëä", art: "die", type: "noun" },
        { de: "Lampe", cn: "Ááà", art: "die", type: "noun" },
        { de: "Schere", cn: "Ââ™ÂàÄ", art: "die", type: "noun" },
        { de: "Waschmaschine", cn: "Ê¥óË°£Ê©ü", art: "die", type: "noun" },
        { de: "Wortliste", cn: "ÂñÆÂ≠óË°®", art: "die", type: "noun" },
        { de: "K√§uferin", cn: "Â•≥Ë≤∑Êñπ", art: "die", type: "noun" },
        { de: "Verk√§uferin", cn: "Â•≥Ë≥£Êñπ", art: "die", type: "noun" },
        { de: "Tasche", cn: "ÂåÖÂåÖ", art: "die", type: "noun" },
        { de: "Ziffer", cn: "Êï∏Â≠ó", art: "die", type: "noun" },
        { de: "Uhr", cn: "Èêò/ÈªûÈêò", art: "die", type: "noun" },
        { de: "Arbeit", cn: "Â∑•‰Ωú", art: "die", type: "noun" },
        { de: "Kinderkrippe", cn: "ÊâòÂÖíÊâÄ", art: "die", type: "noun" },
        { de: "Minute", cn: "ÂàÜÈêò", art: "die", type: "noun" },
        { de: "Schule", cn: "Â≠∏Ê†°", art: "die", type: "noun" },
        { de: "Tageszeit", cn: "ÁôΩÂ§©ÊôÇÈñì", art: "die", type: "noun" },
        { de: "Tochter", cn: "Â•≥ÂÖí", art: "die", type: "noun" },
        { de: "Zeitung", cn: "Â†±Á¥ô", art: "die", type: "noun" },
        { de: "Mittagspause", cn: "Âçà‰ºë", art: "die", type: "noun" },
        { de: "B√§ckerei", cn: "È∫µÂåÖÂ∫ó", art: "die", type: "noun" },
        { de: "Bibliothek", cn: "ÂúñÊõ∏È§®", art: "die", type: "noun" },

        // --- PAGE 1: Das ---
        { de: "Verkaufsgespr√§ch", cn: "Èä∑ÂîÆË©±È°å", art: "das", type: "noun" },
        { de: "B√ºgeleisen", cn: "ÁÜ®Êñó", art: "das", type: "noun" },
        { de: "Heft", cn: "ÂÜäÂ≠ê/Á≠ÜË®òÊú¨", art: "das", type: "noun" },
        { de: "W√∂rterbuch", cn: "Â≠óÂÖ∏", art: "das", type: "noun" },
        { de: "Nomen", cn: "ÂêçË©û", art: "das", type: "noun" },
        { de: "Buch", cn: "Êõ∏", art: "das", type: "noun" },
        { de: "Fahrrad", cn: "ËÖ≥Ë∏èËªä", art: "das", type: "noun" },
        { de: "Haus", cn: "ÊàøÂ≠ê", art: "das", type: "noun" },
        { de: "Jahr", cn: "Âπ¥", art: "das", type: "noun" },
        { de: "Kind", cn: "Â∞èÂ≠©", art: "das", type: "noun" },
        { de: "Abendessen", cn: "ÊôöÈ§ê", art: "das", type: "noun" },
        { de: "Praktikum", cn: "ÂØ¶Áøí", art: "das", type: "noun" },
        { de: "Viertel", cn: "ÂõõÂàÜ‰πã‰∏Ä/‰∏ÄÂàª", art: "das", type: "noun" },
        { de: "Br√∂tchen", cn: "Â∞èÈ∫µÂåÖ", art: "das", type: "noun" },
        { de: "Kino", cn: "ÈõªÂΩ±Èô¢", art: "das", type: "noun" },
        { de: "Fernsehprogramm", cn: "ÈõªË¶ñÁØÄÁõÆ", art: "das", type: "noun" },
        { de: "Bier", cn: "Âï§ÈÖí", art: "das", pl: "-e", type: "noun" },
        { de: "Brot", cn: "È∫µÂåÖ", art: "das", pl: "-e", type: "noun" },
        { de: "Fleisch", cn: "ËÇâ", art: "das", pl: "Sg.", type: "noun" },
        { de: "Gem√ºse", cn: "Ëî¨Ëèú", art: "das", pl: "Sg.", type: "noun" },
        { de: "Obst", cn: "Ê∞¥Êûú", art: "das", pl: "Sg.", type: "noun" },
        { de: "Kochrezept", cn: "È£üË≠ú", art: "das", pl: "-e", type: "noun" },
        { de: "Ei", cn: "Ëõã", art: "das", pl: "-er", type: "noun" },

        // --- PAGE 2 & 3 Selection ---
        { de: "Woche", cn: "ÈÄ±", art: "die", type: "noun" },
        { de: "Banane", cn: "È¶ôËïâ", art: "die", pl: "-n", type: "noun" },
        { de: "Dienstag", cn: "ÊòüÊúü‰∫å", art: "der", type: "noun" },
        { de: "Ehepaar", cn: "Â§´Â¶ª", art: "das", pl: "-e", type: "noun" },
        { de: "Wurst", cn: "È¶ôËÖ∏", art: "die", pl: "W√ºrste", type: "noun" },
        { de: "Kartoffel", cn: "È¶¨Èà¥ËñØ", art: "die", pl: "-n", type: "noun" },
        { de: "Farbe", cn: "È°èËâ≤", art: "die", pl: "-n", type: "noun" },
        { de: "Flasche", cn: "Áì∂Â≠ê", art: "die", pl: "-n", type: "noun" },
        { de: "Salz", cn: "ÈπΩ", art: "das", pl: "Sg.", type: "noun" },
        { de: "Nudel", cn: "È∫µ", art: "die", pl: "-n", type: "noun" },
        { de: "Pizza", cn: "Êä´Ëñ©", art: "die", pl: "-s", type: "noun" },
        { de: "Paprika", cn: "ÁîúÊ§í", art: "die", pl: "-s", type: "noun" },
        { de: "Apfel", cn: "ËòãÊûú", art: "der", pl: "√Ñpfel", type: "noun" },
        { de: "Familie", cn: "ÂÆ∂Â∫≠", art: "die", pl: "-n", type: "noun" },
        { de: "K√§se", cn: "‰π≥ÈÖ™", art: "der", pl: "Sg.", type: "noun" },
        { de: "Marmelade", cn: "ÊûúÈÜ¨", art: "die", pl: "-n", type: "noun" },
        { de: "Kuchen", cn: "ËõãÁ≥ï", art: "der", pl: "-", type: "noun" },
        { de: "Salat", cn: "Ê≤ôÊãâ", art: "der", pl: "-e", type: "noun" },
        { de: "Zitrone", cn: "Ê™∏Ê™¨", art: "die", pl: "-n", type: "noun" },
        { de: "Schinken", cn: "ÁÅ´ËÖø", art: "der", pl: "-", type: "noun" },
        { de: "Zwiebel", cn: "Ê¥ãËî•", art: "die", pl: "-n", type: "noun" },
        { de: "Reis", cn: "Á±≥", art: "der", pl: "Sg.", type: "noun" },
        { de: "Wein", cn: "Ëë°ËêÑÈÖí", art: "der", pl: "-e", type: "noun" },
        { de: "Apfelsaft", cn: "ËòãÊûúÊ±Å", art: "der", pl: "-e", type: "noun" },
        { de: "beschreiben", cn: "ÊèèËø∞", type: "other" },
        { de: "billig", cn: "‰æøÂÆú", type: "other" },
        { de: "teuer", cn: "Ë≤¥", type: "other" },
        { de: "kaputt", cn: "Â£û‰∫Ü", type: "other" },
        { de: "klein", cn: "Â∞è", type: "other" },
        { de: "neu", cn: "Êñ∞", type: "other" },
        { de: "blau", cn: "ËóçËâ≤", type: "other" },
        { de: "rot", cn: "Á¥ÖËâ≤", type: "other" },
        { de: "gr√ºn", cn: "Á∂†Ëâ≤", type: "other" },
        { de: "essen", cn: "ÂêÉ", type: "other" },
        { de: "schauen", cn: "Áúã", type: "other" },
        { de: "kochen", cn: "ÁÖÆÈ£Ø", type: "other" }
    ];

    // --- Audio Synthesis (Web Audio API) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            // High ping (Ding!)
            osc.type = 'sine';
            osc.frequency.setValueAtTime(500, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else if (type === 'wrong') {
            // Low thud (Bubu)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- Game Logic ---
    let currentQIndex = 0;
    let shuffledVocab = [];
    let isAnswered = false;

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function initGame() {
        shuffledVocab = shuffle([...vocabData]);
        currentQIndex = 0;
        loadQuestion();
    }

    function loadQuestion() {
        isAnswered = false;
        const item = shuffledVocab[currentQIndex];
        const progress = (currentQIndex / shuffledVocab.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;
        
        // Hide Bottom Sheet
        const sheet = document.getElementById('bottom-sheet');
        sheet.classList.remove('show', 'correct', 'wrong');

        const gameArea = document.getElementById('game-area');
        gameArea.innerHTML = '';

        // Randomly decide question type: 0 = Article, 1 = Meaning
        // If not a noun, force Meaning type
        let qType = Math.random() > 0.5 ? 0 : 1;
        if (item.type !== 'noun') qType = 1;

        if (qType === 0) {
            renderArticleQuestion(item, gameArea);
        } else {
            renderMeaningQuestion(item, gameArea);
        }
    }

    // --- Renderers ---
    function renderArticleQuestion(item, container) {
        const h2 = document.createElement('h2');
        h2.textContent = "Ë´ãÈÅ∏ÊìáÊ≠£Á¢∫ÁöÑË©ûÊÄß";
        container.appendChild(h2);

        const wordDisplay = document.createElement('div');
        wordDisplay.className = 'word-display';
        wordDisplay.innerHTML = `<span class="word-icon">üì¶</span> ${item.de}`;
        container.appendChild(wordDisplay);

        const grid = document.createElement('div');
        grid.className = 'options-grid articles';
        
        ['der', 'die', 'das'].forEach(art => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.textContent = art.charAt(0).toUpperCase() + art.slice(1);
            btn.onclick = () => checkAnswer(art, item.art, btn, item);
            grid.appendChild(btn);
        });
        container.appendChild(grid);
    }

    function renderMeaningQuestion(item, container) {
        const h2 = document.createElement('h2');
        h2.textContent = "ÈÅ∏Âá∫Ê≠£Á¢∫ÁöÑÊÑèÊÄù";
        container.appendChild(h2);

        const wordDisplay = document.createElement('div');
        wordDisplay.className = 'word-display';
        wordDisplay.innerHTML = `<span class="word-icon">üá©üá™</span> ${item.de}`;
        container.appendChild(wordDisplay);

        // Generate options (1 correct + 3 wrong)
        let options = [item.cn];
        const distractors = vocabData.filter(x => x.cn !== item.cn);
        shuffle(distractors).slice(0, 3).forEach(d => options.push(d.cn));
        options = shuffle(options);

        const grid = document.createElement('div');
        grid.className = 'options-grid choices';

        options.forEach(opt => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.textContent = opt;
            btn.onclick = () => checkAnswer(opt, item.cn, btn, item);
            grid.appendChild(btn);
        });
        container.appendChild(grid);
    }

    // --- Interaction ---
    function checkAnswer(userChoice, correctChoice, btnElement, item) {
        if (isAnswered) return;
        isAnswered = true;

        const sheet = document.getElementById('bottom-sheet');
        const feedbackMsg = document.getElementById('feedback-msg');
        const feedbackDetail = document.getElementById('feedback-detail');
        const feedbackIcon = document.getElementById('feedback-icon');

        if (userChoice === correctChoice) {
            // Correct
            btnElement.classList.add('correct');
            playSound('correct');
            sheet.className = 'bottom-sheet show correct';
            feedbackMsg.firstChild.textContent = "Â§™Ê£í‰∫ÜÔºÅ"; // Update text node
            feedbackIcon.textContent = "üéâ";
        } else {
            // Wrong
            btnElement.classList.add('wrong');
            playSound('wrong');
            sheet.className = 'bottom-sheet show wrong';
            feedbackMsg.firstChild.textContent = "Ê≠£Á¢∫Á≠îÊ°àÊòØÔºö";
            feedbackIcon.textContent = "üíî";
            
            // Highlight the correct one (if visible)
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => {
                if (b.textContent.toLowerCase() === correctChoice.toLowerCase() || 
                    b.textContent === correctChoice) {
                    b.classList.add('correct'); // Show user which was right
                }
            });
        }

        // Detail info (Full word + Plural)
        let detailText = "";
        if (item.type === 'noun') {
            detailText = `${item.art.toUpperCase()} ${item.de} = ${item.cn}`;
            if (item.pl) detailText += ` (Ë§áÊï∏: ${item.pl})`;
        } else {
            detailText = `${item.de} = ${item.cn}`;
        }
        feedbackDetail.textContent = detailText;
    }

    function nextQuestion() {
        currentQIndex++;
        if (currentQIndex >= shuffledVocab.length) {
            // End of round
            alert("ÊÅ≠ÂñúÔºÅ‰Ω†ÂÆåÊàê‰∫ÜÈÄô‰∏ÄËº™ÁöÑÂñÆÂ≠óÁâπË®ìÔºÅ");
            initGame();
        } else {
            loadQuestion();
        }
    }

    // Start
    initGame();

</script>
</body>
</html>